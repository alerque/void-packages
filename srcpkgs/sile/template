# Template file for 'sile'
pkgname=sile
version=0.10.9
revision=1
build_style=gnu-configure
hostmakedepends="pkg-config"
makedepends="fontconfig-devel harfbuzz-devel icu-devel lua51
	lua51-cassowary lua51-cliargs lua51-cosmo lua51-epnf lua51-linenoise lua51-penlight
	lua51-repl lua51-stdlib lua51-vstruct lua51-zlib lua51-bitlib lua51-lpeg
	lua51-luasec lua51-zlib lua51-luaexpat lua51-luafilesystem lua51-luasocket"
depends="fonts-sil-gentium lua51
	lua51-cassowary lua51-cliargs lua51-cosmo lua51-epnf lua51-linenoise lua51-penlight
	lua51-repl lua51-stdlib lua51-vstruct lua51-zlib lua51-bitlib lua51-lpeg
	lua51-luasec lua51-zlib lua51-luaexpat lua51-luafilesystem lua51-luasocket"
short_desc="Modern typesetting system inspired by TeX"
maintainer="John <me@johnnynator.dev>"
license="MIT"
homepage="https://www.sile-typesetter.org"
distfiles="https://github.com/sile-typesetter/sile/releases/download/v${version}/sile-${version}.tar.bz2"
checksum=44eaaf286b059b46eb51f28ef813d149538b06f4541c1eb7fb6faef26d60a564

if [ "$CROSS_BUILD" ]; then
	hostmakedepends+=" lua51 lua51-lpeg luaexpat lua51-zlib lua51-luafilesystem
	 lua51-luasocket lua51-luasec"
fi

post_install() {
	vlicense LICENSE
}

libtexpdf_package() {
	short_desc="PDF library extracted from TeX's dvipdfmx"
	pkg_install() {
		# TODO: May not be necessary in v0.10.3
		vmove "usr/lib/libtexpdf.so.*"
	}
}

libtexpdf-devel_package() {
	short_desc="PDF library extracted from TeX's dvipdfmx - (development files)"
	depends="libtexpdf-${version}_${revision}"
	pkg_install() {
		vmove usr/include
		# TODO: May not be necessary in v0.10.3
		vmove "usr/lib/*.so"
		vmove "usr/lib/*.a"
	}
}
